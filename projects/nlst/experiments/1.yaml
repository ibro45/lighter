project: /home/ibrahim/projects/lightningbringer/projects/nlst

trainer:
    _target_: pytorch_lightning.Trainer
    max_epochs: 5000
    gpus: 1
    precision: 16
    accelerator: null
    deterministic: True
    default_root_dir: /home/ibrahim/projects/lightningbringer/projects/nlst/logs
    logger:
        - _target_: pytorch_lightning.loggers.WandbLogger
          save_dir: ${trainer.default_root_dir}
          project: packyear_4class


system:
    _target_: lightningbringer.System
    batch_size: 4
    pin_memory: True
    num_workers: 8
    log_input_as: "image_single"

    model:
        _target_: monai.networks.nets.EfficientNetBN
        model_name: efficientnet-b0
        pretrained: False
        spatial_dims: 3
        in_channels: 1
        num_classes: 4

    criterion:
        _target_: torch.nn.CrossEntropyLoss

    optimizers:
        _target_: torch.optim.Adam
        lr: 0.001
        weight_decay: 1e-5

    metrics:
        - _target_: torchmetrics.Accuracy
        - _target_: torchmetrics.F1

    train_dataset:
        _target_: project.datasets.NLSTDataset
        scans_dir: /mnt/ssd1/NLST/nrrd/
        masks_dir: /mnt/ssd1/NLST/lung_masks/
        labels_path: /mnt/ssd1/NLST/NLST_clinical_whole.csv
        label: packyear
        hounsfield_units_range: [-1000, 400]
        patch_size: [128, 304, 392]