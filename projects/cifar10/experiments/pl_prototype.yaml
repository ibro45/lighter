project: /mnt/particija/lightningbringer/projects/cifar10

trainer:
    _target_: pytorch_lightning.Trainer
    max_epochs: 50
    gpus: 0
    accelerator: null
    default_root_dir: ./logs
    logger:
        - _target_: pytorch_lightning.loggers.TensorBoardLogger
          save_dir: ${trainer.default_root_dir}
          name: tensorboard

        - _target_: pytorch_lightning.loggers.WandbLogger
          save_dir: ${trainer.default_root_dir}


system:
    _target_: lightningbringer.System
    batch_size: 512
    pin_memory: True
    num_workers: 4
    log_input_as: "image_batch"

    model:
        _target_: project.models.net.Net

    criterion:
        _target_: torch.nn.CrossEntropyLoss

    optimizers:
        _target_: torch.optim.Adam
        lr: 0.001
        weight_decay: 1e-5

    metrics:
        - _target_: torchmetrics.Accuracy
        - _target_: torchmetrics.F1

    train_dataset:
        _target_: torchvision.datasets.CIFAR10
        download: False
        root: /mnt/particija/lightningbringer/.datasets/
        train: True
        transform:
            _target_: torchvision.transforms.Compose
            transforms:
                - _target_: torchvision.transforms.ToTensor
                - _target_: torchvision.transforms.Normalize
                  mean: [0.5, 0.5, 0.5]
                  std: [0.5, 0.5, 0.5]
        target_transform: null
    
    val_dataset:
        _target_: torchvision.datasets.CIFAR10
        download: False
        root: /mnt/particija/lightningbringer/.datasets/
        train:  False  # Same as test, for prototyping purposes only
        transform:
            _target_: torchvision.transforms.Compose
            transforms:
                - _target_: torchvision.transforms.ToTensor
                - _target_: torchvision.transforms.Normalize
                  mean: [0.5, 0.5, 0.5]
                  std: [0.5, 0.5, 0.5]
        target_transform: null
    
    test_dataset:
        _target_: torchvision.datasets.CIFAR10
        download: False
        root: /mnt/particija/lightningbringer/.datasets/
        train: False
        transform:
            _target_: torchvision.transforms.Compose
            transforms:
                - _target_: torchvision.transforms.ToTensor
                - _target_: torchvision.transforms.Normalize
                  mean: [0.5, 0.5, 0.5]
                  std: [0.5, 0.5, 0.5]
        target_transform: null
